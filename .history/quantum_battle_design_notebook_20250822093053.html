<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Quantum Battle System Designer</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', system-ui, -apple-system, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            padding: 20px;
            color: #333;
        }

        .container {
            max-width: 1400px;
            margin: 0 auto;
        }

        .header {
            text-align: center;
            color: white;
            margin-bottom: 30px;
            padding: 20px;
            background: rgba(255, 255, 255, 0.1);
            backdrop-filter: blur(10px);
            border-radius: 15px;
        }

        .header h1 {
            font-size: 2.5em;
            margin-bottom: 10px;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.3);
        }

        .header p {
            font-size: 1.2em;
            opacity: 0.95;
        }

        .module-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(400px, 1fr));
            gap: 20px;
            margin-bottom: 30px;
        }

        .module-card {
            background: white;
            border-radius: 15px;
            padding: 25px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.2);
            transition: transform 0.3s ease, box-shadow 0.3s ease;
        }

        .module-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 15px 40px rgba(0,0,0,0.3);
        }

        .module-title {
            font-size: 1.4em;
            font-weight: bold;
            color: #667eea;
            margin-bottom: 15px;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .module-icon {
            font-size: 1.5em;
        }

        /* 初期配置モジュール */
        .placement-board {
            display: grid;
            grid-template-columns: repeat(6, 50px);
            grid-template-rows: repeat(6, 50px);
            gap: 2px;
            margin: 20px auto;
            background: #444;
            padding: 10px;
            border-radius: 10px;
            width: fit-content;
        }

        .board-cell {
            background: #f0f0f0;
            border: 1px solid #ccc;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            transition: all 0.3s ease;
            font-size: 20px;
            position: relative;
        }

        .board-cell:hover {
            background: #e0e0e0;
            transform: scale(1.1);
            z-index: 10;
        }

        .board-cell.player-a {
            background: #4CAF50;
            color: white;
        }

        .board-cell.player-b {
            background: #2196F3;
            color: white;
        }

        .board-cell.good {
            font-weight: bold;
        }

        .board-cell.bad::after {
            content: '❓';
            position: absolute;
            top: -5px;
            right: -5px;
            font-size: 12px;
        }

        /* 敵駒推定モジュール */
        .quantum-config {
            background: linear-gradient(135deg, #f5f7fa 0%, #c3cfe2 100%);
            padding: 20px;
            border-radius: 10px;
            margin: 20px 0;
        }

        .config-item {
            margin: 15px 0;
        }

        .config-label {
            font-weight: bold;
            color: #555;
            display: block;
            margin-bottom: 5px;
        }

        .slider-container {
            display: flex;
            align-items: center;
            gap: 15px;
        }

        input[type="range"] {
            flex: 1;
            height: 6px;
            border-radius: 3px;
            background: linear-gradient(to right, #667eea, #764ba2);
            outline: none;
            cursor: pointer;
        }

        input[type="range"]::-webkit-slider-thumb {
            -webkit-appearance: none;
            appearance: none;
            width: 20px;
            height: 20px;
            border-radius: 50%;
            background: white;
            box-shadow: 0 2px 5px rgba(0,0,0,0.3);
            cursor: pointer;
        }

        .value-display {
            background: white;
            padding: 5px 10px;
            border-radius: 5px;
            min-width: 50px;
            text-align: center;
            font-weight: bold;
            color: #667eea;
        }

        /* エンべディング選択 */
        .embedding-options {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 10px;
            margin: 15px 0;
        }

        .embedding-card {
            background: white;
            padding: 15px;
            border-radius: 8px;
            border: 2px solid transparent;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .embedding-card:hover {
            border-color: #667eea;
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(102, 126, 234, 0.3);
        }

        .embedding-card.selected {
            border-color: #764ba2;
            background: linear-gradient(135deg, rgba(102, 126, 234, 0.1), rgba(118, 75, 162, 0.1));
        }

        .embedding-title {
            font-weight: bold;
            color: #333;
            margin-bottom: 5px;
        }

        .embedding-desc {
            font-size: 0.9em;
            color: #666;
        }

        /* モジュール選択 */
        .module-selector {
            background: #f9f9f9;
            padding: 15px;
            border-radius: 10px;
            margin: 20px 0;
        }

        .selector-title {
            font-weight: bold;
            color: #555;
            margin-bottom: 10px;
        }

        .option-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
            gap: 10px;
        }

        .option-button {
            padding: 12px 20px;
            border: 2px solid #ddd;
            background: white;
            border-radius: 8px;
            cursor: pointer;
            transition: all 0.3s ease;
            text-align: center;
        }

        .option-button:hover {
            border-color: #667eea;
            background: linear-gradient(135deg, rgba(102, 126, 234, 0.05), rgba(118, 75, 162, 0.05));
            transform: translateY(-2px);
        }

        .option-button.selected {
            border-color: #764ba2;
            background: linear-gradient(135deg, #667eea, #764ba2);
            color: white;
            font-weight: bold;
        }

        /* コード生成エリア */
        .code-output {
            background: #1e1e1e;
            color: #d4d4d4;
            padding: 20px;
            border-radius: 10px;
            margin-top: 30px;
            font-family: 'Consolas', 'Monaco', monospace;
            overflow-x: auto;
            box-shadow: 0 10px 30px rgba(0,0,0,0.3);
        }

        .code-header {
            color: #569cd6;
            font-weight: bold;
            margin-bottom: 15px;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .copy-button {
            background: #4CAF50;
            color: white;
            border: none;
            padding: 8px 15px;
            border-radius: 5px;
            cursor: pointer;
            transition: background 0.3s ease;
        }

        .copy-button:hover {
            background: #45a049;
        }

        .code-line {
            margin: 5px 0;
            line-height: 1.6;
        }

        .code-keyword {
            color: #569cd6;
        }

        .code-string {
            color: #ce9178;
        }

        .code-number {
            color: #b5cea8;
        }

        .code-comment {
            color: #6a9955;
            font-style: italic;
        }

        /* アニメーション */
        @keyframes pulse {
            0% { transform: scale(1); }
            50% { transform: scale(1.05); }
            100% { transform: scale(1); }
        }

        .pulse {
            animation: pulse 2s infinite;
        }

        /* Jupyter Notebook スタイル */
        .notebook-cell {
            background: white;
            border-left: 4px solid #4CAF50;
            margin: 20px 0;
            padding: 15px;
            border-radius: 5px;
            box-shadow: 0 2px 5px rgba(0,0,0,0.1);
        }

        .cell-number {
            color: #888;
            font-family: monospace;
            margin-bottom: 10px;
        }

        .run-button {
            background: #4CAF50;
            color: white;
            border: none;
            padding: 10px 20px;
            border-radius: 5px;
            cursor: pointer;
            font-size: 1em;
            margin-top: 15px;
            transition: background 0.3s ease;
        }

        .run-button:hover {
            background: #45a049;
        }

        .output-area {
            background: #f5f5f5;
            padding: 15px;
            border-radius: 5px;
            margin-top: 15px;
            font-family: monospace;
            white-space: pre-wrap;
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>Quantum Battle System Designer</h1>
            <p>各モジュールを設計・選択して、あなただけのAI戦略を構築しよう</p>
        </div>

        <div class="module-grid">
            <!-- モジュール1: 初期配置 -->
            <div class="module-card">
                <div class="module-title">
                    <span class="module-icon">♟️</span>
                    モジュール1: 初期配置戦略
                </div>
                
                <div class="notebook-cell">
                    <div class="cell-number">In [1]:</div>
                    <p>駒の初期配置を設定します。クリックして配置を変更できます。</p>
                    
                    <div class="placement-board" id="placementBoard">
                        <!-- ボードは JavaScript で生成 -->
                    </div>
                    
                    <div class="module-selector">
                        <div class="selector-title">配置テンプレート：</div>
                        <div class="option-grid">
                            <div class="option-button selected" onclick="selectPlacement('standard')">
                                🎯 標準配置
                            </div>
                            <div class="option-button" onclick="selectPlacement('custom')">
                                ✏️ カスタム
                            </div>
                        </div>
                    </div>
                    
                    <button class="run-button" onclick="runPlacement()">▶ 配置を実行</button>
                    <div class="output-area" id="placementOutput" style="display: none;"></div>
                </div>
            </div>

            <!-- モジュール2: 敵駒推定 -->
            <div class="module-card">
                <div class="module-title">
                    <span class="module-icon">🔬</span>
                    モジュール2: 敵駒推定（CQCNN）
                </div>
                
                <div class="notebook-cell">
                    <div class="cell-number">In [2]:</div>
                    <div class="quantum-config">
                        <div class="config-item">
                            <label class="config-label">🔢 量子ビット数（n_qubits）:</label>
                            <div class="slider-container">
                                <input type="range" id="qubitsSlider" min="4" max="12" value="8" 
                                       oninput="updateValue('qubits', this.value)">
                                <div class="value-display" id="qubitsValue">8</div>
                            </div>
                        </div>
                        
                        <div class="config-item">
                            <label class="config-label">📚 レイヤー数（n_layers）:</label>
                            <div class="slider-container">
                                <input type="range" id="layersSlider" min="1" max="6" value="3" 
                                       oninput="updateValue('layers', this.value)">
                                <div class="value-display" id="layersValue">3</div>
                            </div>
                        </div>
                        
                        <div class="config-item">
                            <label class="config-label">🎨 エンべディング種類:</label>
                            <div class="embedding-options">
                                <div class="embedding-card selected" onclick="selectEmbedding('angle')">
                                    <div class="embedding-title">📐 Angle Embedding</div>
                                    <div class="embedding-desc">回転ゲートベースの古典データ埋め込み</div>
                                </div>
                                <div class="embedding-card" onclick="selectEmbedding('amplitude')">
                                    <div class="embedding-title">📊 Amplitude Embedding</div>
                                    <div class="embedding-desc">振幅エンコーディング（効率的）</div>
                                </div>
                                <div class="embedding-card" onclick="selectEmbedding('iqp')">
                                    <div class="embedding-title">🌀 IQP Embedding</div>
                                    <div class="embedding-desc">瞬間量子多項式回路</div>
                                </div>
                                <div class="embedding-card" onclick="selectEmbedding('basis')">
                                    <div class="embedding-title">🔷 Basis Embedding</div>
                                    <div class="embedding-desc">基底状態エンコーディング</div>
                                </div>
                            </div>
                        </div>
                        
                        <div class="config-item">
                            <label class="config-label">🔗 エンタングルメント構造:</label>
                            <div class="option-grid">
                                <div class="option-button selected" onclick="selectEntanglement('linear')">
                                    Linear
                                </div>
                                <div class="option-button" onclick="selectEntanglement('circular')">
                                    Circular
                                </div>
                                <div class="option-button" onclick="selectEntanglement('full')">
                                    Full
                                </div>
                            </div>
                        </div>
                    </div>
                    
                    <button class="run-button" onclick="runQuantumConfig()">▶ 量子回路を構築</button>
                    <div class="output-area" id="quantumOutput" style="display: none;"></div>
                </div>
            </div>

            <!-- モジュール3: 報酬関数 -->
            <div class="module-card">
                <div class="module-title">
                    <span class="module-icon">💰</span>
                    モジュール3: 報酬関数
                </div>
                
                <div class="notebook-cell">
                    <div class="cell-number">In [3]:</div>
                    <div class="module-selector">
                        <div class="selector-title">報酬戦略を選択：</div>
                        <div class="option-grid">
                            <div class="option-button selected" onclick="selectReward('balanced')">
                                ⚖️ バランス型
                            </div>
                            <div class="option-button" onclick="selectReward('aggressive')">
                                🗡️ 攻撃重視
                            </div>
                            <div class="option-button" onclick="selectReward('defensive')">
                                🛡️ 防御重視
                            </div>
                            <div class="option-button" onclick="selectReward('escape')">
                                🏃 脱出重視
                            </div>
                        </div>
                    </div>
                    
                    <button class="run-button" onclick="runReward()">▶ 報酬関数を設定</button>
                    <div class="output-area" id="rewardOutput" style="display: none;"></div>
                </div>
            </div>

            <!-- モジュール4: Q値マップ -->
            <div class="module-card">
                <div class="module-title">
                    <span class="module-icon">🗺️</span>
                    モジュール4: Q値マップ
                </div>
                
                <div class="notebook-cell">
                    <div class="cell-number">In [4]:</div>
                    <div class="module-selector">
                        <div class="selector-title">Q値計算方法：</div>
                        <div class="option-grid">
                            <div class="option-button selected" onclick="selectQMap('dqn')">
                                🧠 DQN
                            </div>
                            <div class="option-button" onclick="selectQMap('sarsa')">
                                📈 SARSA
                            </div>
                            <div class="option-button" onclick="selectQMap('montecarlo')">
                                🎲 モンテカルロ
                            </div>
                            <div class="option-button" onclick="selectQMap('tabular')">
                                📊 テーブル型
                            </div>
                        </div>
                    </div>
                    
                    <button class="run-button" onclick="runQMap()">▶ Q値マップを生成</button>
                    <div class="output-area" id="qmapOutput" style="display: none;"></div>
                </div>
            </div>

            <!-- モジュール5: 行動選択 -->
            <div class="module-card">
                <div class="module-title">
                    <span class="module-icon">🎯</span>
                    モジュール5: 行動選択
                </div>
                
                <div class="notebook-cell">
                    <div class="cell-number">In [5]:</div>
                    <div class="module-selector">
                        <div class="selector-title">行動選択戦略：</div>
                        <div class="option-grid">
                            <div class="option-button selected" onclick="selectAction('epsilon')">
                                🎰 ε-greedy
                            </div>
                            <div class="option-button" onclick="selectAction('boltzmann')">
                                🌡️ ボルツマン
                            </div>
                            <div class="option-button" onclick="selectAction('ucb')">
                                📊 UCB
                            </div>
                            <div class="option-button" onclick="selectAction('thompson')">
                                🎲 トンプソン
                            </div>
                        </div>
                    </div>
                    
                    <button class="run-button" onclick="runAction()">▶ 行動選択を実行</button>
                    <div class="output-area" id="actionOutput" style="display: none;"></div>
                </div>
            </div>
        </div>

        <!-- 統合コード生成 -->
        <div class="code-output">
            <div class="code-header">
                <span>📝 生成されたPythonコード（Jupyter Notebook用）</span>
                <button class="copy-button" onclick="copyCode()">📋 コピー</button>
            </div>
            <pre id="generatedCode"></pre>
        </div>
    </div>

    <script>
        // グローバル変数
        let currentConfig = {
            placement: 'standard',
            qubits: 8,
            layers: 3,
            embedding: 'angle',
            entanglement: 'linear',
            reward: 'balanced',
            qmap: 'dqn',
            action: 'epsilon',
            board: Array(6).fill().map(() => Array(6).fill(0))
        };

        // 初期化
        document.addEventListener('DOMContentLoaded', function() {
            initializeBoard();
            updateCode();
        });

        // ボード初期化
        function initializeBoard() {
            const board = document.getElementById('placementBoard');
            board.innerHTML = '';
            
            // 標準配置
            const standardPlacement = {
                // Player A (rows 0-1)
                '0,1': 'A-good', '0,2': 'A-good', '0,3': 'A-bad', '0,4': 'A-bad',
                '1,1': 'A-good', '1,2': 'A-bad', '1,3': 'A-good', '1,4': 'A-bad',
                // Player B (rows 4-5)
                '4,1': 'B-bad', '4,2': 'B-good', '4,3': 'B-bad', '4,4': 'B-good',
                '5,1': 'B-bad', '5,2': 'B-bad', '5,3': 'B-good', '5,4': 'B-good'
            };
            
            for (let row = 0; row < 6; row++) {
                for (let col = 0; col < 6; col++) {
                    const cell = document.createElement('div');
                    cell.className = 'board-cell';
                    cell.dataset.row = row;
                    cell.dataset.col = col;
                    
                    const key = `${row},${col}`;
                    if (standardPlacement[key]) {
                        const [player, type] = standardPlacement[key].split('-');
                        cell.classList.add(`player-${player.toLowerCase()}`, type);
                        cell.textContent = type === 'good' ? '👑' : '♟️';
                        currentConfig.board[row][col] = player === 'A' ? 
                            (type === 'good' ? 1 : -1) : 
                            (type === 'good' ? 2 : -2);
                    }
                    
                    cell.onclick = () => togglePiece(row, col);
                    board.appendChild(cell);
                }
            }
        }

        // 駒の切り替え
        function togglePiece(row, col) {
            if (currentConfig.placement !== 'custom') {
                currentConfig.placement = 'custom';
                document.querySelectorAll('.module-selector .option-button').forEach(btn => {
                    btn.classList.remove('selected');
                    if (btn.textContent.includes('カスタム')) {
                        btn.classList.add('selected');
                    }
                });
            }
            
            const cell = document.querySelector(`[data-row="${row}"][data-col="${col}"]`);
            const current = currentConfig.board[row][col];
            
            // サイクル: 0 -> A-good -> A-bad -> B-good -> B-bad -> 0
            const cycle = [0, 1, -1, 2, -2];
            const nextIndex = (cycle.indexOf(current) + 1) % cycle.length;
            const next = cycle[nextIndex];
            
            currentConfig.board[row][col] = next;
            
            // UIを更新
            cell.className = 'board-cell';
            cell.textContent = '';
            
            if (next !== 0) {
                const player = Math.abs(next) === 1 ? 'a' : 'b';
                const type = next > 0 ? 'good' : 'bad';
                cell.classList.add(`player-${player}`, type);
                cell.textContent = type === 'good' ? '👑' : '♟️';
            }
            
            updateCode();
        }

        // 配置選択
        function selectPlacement(type) {
            currentConfig.placement = type;
            document.querySelectorAll('.module-selector .option-button').forEach(btn => {
                btn.classList.remove('selected');
            });
            event.target.classList.add('selected');
            
            if (type !== 'custom') {
                // プリセット配置を適用
                initializeBoard();
            }
            updateCode();
        }

        // 値の更新
        function updateValue(type, value) {
            currentConfig[type] = parseInt(value);
            document.getElementById(`${type}Value`).textContent = value;
            updateCode();
        }

        // エンべディング選択
        function selectEmbedding(type) {
            currentConfig.embedding = type;
            document.querySelectorAll('.embedding-card').forEach(card => {
                card.classList.remove('selected');
            });
            event.target.closest('.embedding-card').classList.add('selected');
            updateCode();
        }

        // エンタングルメント選択
        function selectEntanglement(type) {
            currentConfig.entanglement = type;
            document.querySelectorAll('.config-item .option-button').forEach(btn => {
                btn.classList.remove('selected');
            });
            event.target.classList.add('selected');
            updateCode();
        }

        // 各モジュール選択
        function selectReward(type) {
            currentConfig.reward = type;
            updateSelection(event.target);
            updateCode();
        }

        function selectQMap(type) {
            currentConfig.qmap = type;
            updateSelection(event.target);
            updateCode();
        }

        function selectAction(type) {
            currentConfig.action = type;
            updateSelection(event.target);
            updateCode();
        }

        function updateSelection(target) {
            target.parentElement.querySelectorAll('.option-button').forEach(btn => {
                btn.classList.remove('selected');
            });
            target.classList.add('selected');
        }

        // 実行ボタン
        function runPlacement() {
            const output = document.getElementById('placementOutput');
            output.style.display = 'block';
            output.textContent = `✅ 初期配置設定完了\n配置タイプ: ${currentConfig.placement}\n善玉の位置: ${countPieces('good')}個\n悪玉の位置: ${countPieces('bad')}個`;
        }

        function runQuantumConfig() {
            const output = document.getElementById('quantumOutput');
            output.style.display = 'block';
            output.textContent = `✅ 量子回路構築完了\n量子ビット数: ${currentConfig.qubits}\nレイヤー数: ${currentConfig.layers}\nエンべディング: ${currentConfig.embedding}\nエンタングルメント: ${currentConfig.entanglement}\n総パラメータ数: ${currentConfig.qubits * currentConfig.layers * 3}`;
        }

        function runReward() {
            const output = document.getElementById('rewardOutput');
            output.style.display = 'block';
            const rewards = {
                balanced: '捕獲: +10, 脱出: +50, 被捕獲: -10',
                aggressive: '捕獲: +20, 脱出: +30, 被捕獲: -5',
                defensive: '捕獲: +5, 脱出: +40, 被捕獲: -20',
                escape: '捕獲: +5, 脱出: +100, 被捕獲: -10'
            };
            output.textContent = `✅ 報酬関数設定完了\n戦略: ${currentConfig.reward}\n${rewards[currentConfig.reward]}`;
        }

        function runQMap() {
            const output = document.getElementById('qmapOutput');
            output.style.display = 'block';
            output.textContent = `✅ Q値マップ生成完了\n方法: ${currentConfig.qmap}\n状態空間: 6x6x4 = 144次元\n行動空間: 4方向`;
        }

        function runAction() {
            const output = document.getElementById('actionOutput');
            output.style.display = 'block';
            const strategies = {
                epsilon: 'ε=0.1で10%の確率でランダム探索',
                boltzmann: '温度τ=1.0でソフトマックス選択',
                ucb: '信頼区間による楽観的探索',
                thompson: 'ベイズ的確率分布からサンプリング'
            };
            output.textContent = `✅ 行動選択戦略設定完了\n戦略: ${currentConfig.action}\n${strategies[currentConfig.action]}`;
        }

        // ヘルパー関数
        function countPieces(type) {
            let count = 0;
            for (let row of currentConfig.board) {
                for (let val of row) {
                    if (type === 'good' && (val === 1 || val === 2)) count++;
                    if (type === 'bad' && (val === -1 || val === -2)) count++;
                }
            }
            return count;
        }

        // コード生成
        function updateCode() {
            const code = `<span class="code-comment"># === Quantum Battle System Configuration ===</span>
<span class="code-comment"># Generated by Interactive Designer</span>

<span class="code-keyword">import</span> numpy <span class="code-keyword">as</span> np
<span class="code-keyword">import</span> torch
<span class="code-keyword">import</span> torch.nn <span class="code-keyword">as</span> nn
<span class="code-keyword">from</span> real_learning_battle_system <span class="code-keyword">import</span> RealLearningBattleSystem

<span class="code-comment"># === モジュール1: 初期配置 ===</span>
placement_config = {
    <span class="code-string">'type'</span>: <span class="code-string">'${currentConfig.placement}'</span>,
    <span class="code-string">'board'</span>: np.array([
${currentConfig.board.map(row => '        ' + JSON.stringify(row)).join(',\n')}
    ])
}

<span class="code-comment"># === モジュール2: 敵駒推定（CQCNN） ===</span>
quantum_config = {
    <span class="code-string">'n_qubits'</span>: <span class="code-number">${currentConfig.qubits}</span>,
    <span class="code-string">'n_layers'</span>: <span class="code-number">${currentConfig.layers}</span>,
    <span class="code-string">'embedding_type'</span>: <span class="code-string">'${currentConfig.embedding}'</span>,
    <span class="code-string">'entanglement'</span>: <span class="code-string">'${currentConfig.entanglement}'</span>,
    <span class="code-string">'total_params'</span>: <span class="code-number">${currentConfig.qubits * currentConfig.layers * 3}</span>
}

<span class="code-comment"># === モジュール3: 報酬関数 ===</span>
reward_config = {
    <span class="code-string">'strategy'</span>: <span class="code-string">'${currentConfig.reward}'</span>,
    <span class="code-string">'capture_reward'</span>: <span class="code-number">${currentConfig.reward === 'aggressive' ? 20 : currentConfig.reward === 'defensive' ? 5 : 10}</span>,
    <span class="code-string">'escape_reward'</span>: <span class="code-number">${currentConfig.reward === 'escape' ? 100 : currentConfig.reward === 'defensive' ? 40 : currentConfig.reward === 'aggressive' ? 30 : 50}</span>,
    <span class="code-string">'captured_penalty'</span>: <span class="code-number">${currentConfig.reward === 'defensive' ? -20 : currentConfig.reward === 'aggressive' ? -5 : -10}</span>
}

<span class="code-comment"># === モジュール4: Q値マップ ===</span>
qmap_config = {
    <span class="code-string">'method'</span>: <span class="code-string">'${currentConfig.qmap}'</span>,
    <span class="code-string">'state_dim'</span>: <span class="code-number">144</span>,  <span class="code-comment"># 6x6x4</span>
    <span class="code-string">'action_dim'</span>: <span class="code-number">4</span>     <span class="code-comment"># 4方向</span>
}

<span class="code-comment"># === モジュール5: 行動選択 ===</span>
action_config = {
    <span class="code-string">'strategy'</span>: <span class="code-string">'${currentConfig.action}'</span>,
    <span class="code-string">'epsilon'</span>: <span class="code-number">0.1</span> <span class="code-keyword">if</span> <span class="code-string">'${currentConfig.action}'</span> == <span class="code-string">'epsilon'</span> <span class="code-keyword">else</span> <span class="code-keyword">None</span>,
    <span class="code-string">'temperature'</span>: <span class="code-number">1.0</span> <span class="code-keyword">if</span> <span class="code-string">'${currentConfig.action}'</span> == <span class="code-string">'boltzmann'</span> <span class="code-keyword">else</span> <span class="code-keyword">None</span>
}

<span class="code-comment"># === システム初期化と実行 ===</span>
<span class="code-keyword">def</span> <span class="code-keyword">create_custom_ai</span>():
    system = RealLearningBattleSystem()
    
    <span class="code-comment"># カスタム設定を適用</span>
    ai_config = {
        <span class="code-string">'placement'</span>: placement_config,
        <span class="code-string">'quantum'</span>: quantum_config,
        <span class="code-string">'reward'</span>: reward_config,
        <span class="code-string">'qmap'</span>: qmap_config,
        <span class="code-string">'action'</span>: action_config
    }
    
    <span class="code-comment"># AIを作成</span>
    custom_ai = system.create_ai_with_config(ai_config)
    <span class="code-keyword">return</span> custom_ai

<span class="code-comment"># 実行</span>
<span class="code-keyword">if</span> __name__ == <span class="code-string">"__main__"</span>:
    ai = create_custom_ai()
    print(<span class="code-string">"✅ カスタムAI作成完了"</span>)
    print(<span class="code-string">f"設定: {ai.get_config()}"</span>)
`;
            
            document.getElementById('generatedCode').innerHTML = code;
        }

        // コードコピー
        function copyCode() {
            const codeElement = document.getElementById('generatedCode');
            const textArea = document.createElement('textarea');
            textArea.value = codeElement.textContent;
            document.body.appendChild(textArea);
            textArea.select();
            document.execCommand('copy');
            document.body.removeChild(textArea);
            
            const button = event.target;
            const originalText = button.textContent;
            button.textContent = '✅ コピー完了！';
            setTimeout(() => {
                button.textContent = originalText;
            }, 2000);
        }
    </script>
</body>
</html>